<?xml version="1.0" encoding="utf-8"?>

<!--

Action buttons (Previous/Save/Next) can be shown "top", "bottom" or "both":
<stage name="type" action_buttons="both">
  <component><field ref="type" required="yes" /></component>
</stage>

-->

<workflow xmlns="http://eprints.org/ep3/workflow" xmlns:epc="http://eprints.org/ep3/control">
  <flow>
    <stage ref="type"/>
    <epc:if test="medmus_type='work'">
      <stage ref="work_core" />
    </epc:if>
    <epc:if test="medmus_type='refrain'">
      <stage ref="refrain_core" />
      <stage ref="files"/>
    </epc:if>
  </flow>

  <stage name="type">
    <component><field ref="medmus_type" required="yes" /></component>
  </stage>

  <stage name="files">
    <component type="Upload" show_help="always" />
    <component type="Documents">
      <field ref="content" />
      <field ref="format" />
      <field ref="formatdesc" />
      <field ref="security" />
      <field ref="license" />
      <field ref="date_embargo" />
<!--  <field ref="relation" /> -->
<!--  <field ref="language" /> --> 
    </component>
  </stage>

  <stage name="refrain_core">
    <component><field ref="title" required="yes" /></component>
  </stage>

  <stage name="work_core">
    <component><field ref="title" required="yes" /></component>
    <component><field ref="generic_descriptor" required="yes" /></component>
    <component><field ref="work_id" required="yes" /></component>
    <component><field ref="date_description" /></component>
    <component><field ref="authors" required="yes"/></component>
    <component><field ref="host_works" /></component>
    <component><field ref="edition" /></component>

    <component type="Field::Multi">
      <title>Indices</title>
      <field ref="l_index"/>
      <field ref="mw_index"/>
      <field ref="rs_index"/>
      <field ref="t_index_motets"/>
      <field ref="t_index_songs"/>
      <field ref="lu_index"/>
      <field ref="vdb_index"/>
    </component>

    <component type="Field::Multi">
      <title>Other Data</title>
      <field ref="number_of_parts" />
      <field ref="voice_in_polyphony" />
      <field ref="primary_language" />
      <field ref="secondary_language" />
      <field ref="style_of_discourse" />
      <field ref="number_of_stanzas" />
      <field ref="number_of_envois" />
    </component>

    <component><field ref="other_data" /></component>
  </stage>

</workflow>
